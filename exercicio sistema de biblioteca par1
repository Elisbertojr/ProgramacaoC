//sistema de biblioteca
//pratica de sistema de biblioteca parte 1
//implementar o cadastro e a listagem de livros usando um Array estático

#include <stdio.h>
#include <stdlib.h>
#include <string.h> // para stc spn()

//Constantes Globais
#define MAX_LIVROS 50
#define TAM_STRING 100

//Definição da Estrutura (struct)
struct Livro{
    char nome [TAM_STRING];
    char autor [TAM_STRING];
    char editora [TAM_STRING];
    int edicao;
};

//Função de limpar buff de entrada
void limparBufferEntrada() {
    int c;
    while ((c = getchar()) != '\n' && c != EOF);
}

//Função Principal (main)
int main() {
    struct Livro biblioteca[MAX_LIVROS];
    int totalLivros = 0;
    int opcao;


//Laço Principal do menu
do{
    //exibe o menu de opções
    printf("========================== \n");
    printf("Biblioteca-parte 1 \n");
    printf("==========================\n");
    printf("1-Cadastrar novo livro \n ");
    printf("2-Listar todos os livros \n");
    printf("0-Sair\n");
    printf("---------------------------\n");
    printf("Escolha uma opção:");

    //Lê a opção do usuario
    scanf("%d", &opcao);
    limparBufferEntrada(); //limpa o '\n' deixado pelo scanf

    //processamento da opção
switch(opcao){
    case 1://cadastro de livro
      printf("---Cadastro do novo livro---\n\n");
      if (totalLivros < MAX_LIVROS){
        printf("Digite o nome do livro:");
        fgets(biblioteca[totalLivros].nome, TAM_STRING,stdin);

        printf("Digite o autor:");
        fgets(biblioteca [totalLivros].autor, TAM_STRING,stdin);

        printf("Digite a editora:");
        fgets(biblioteca[totalLivros].editora, TAM_STRING,stdin);

        biblioteca[totalLivros].nome[strspn(biblioteca[totalLivros].nome,"\n")]='\n';
        biblioteca[totalLivros].autor[strspn(biblioteca[totalLivros].autor,"\n")]='\n';
        biblioteca[totalLivros].editora[strspn(biblioteca[totalLivros].editora,"\n")]='\n';

        printf("Digite a edição:");
        scanf("%d,&biblioteca[totalLivros].edicao");
        limparBufferEntrada();

        totalLivros++;
        //totalLivros=totalLivros +1;

        printf("\n Livro cadastrado com sucesso!\n");

      } else{
        printf("Biblioteca cheia!não é possível cadastrar mais livros.\n");
      }

      printf("\n Pressione Enter para continuar...");
      getchar();//pausa para o usuario ler a mensagem antes de voltar ao menu.
      break;

    case 2://Listagem de Livros
      printf("---Lista de livros cadastrados---\n\n"); 
      if (totalLivros == 0){
        printf("Nenhum livro cadastrado ainda.\n");
      } else{
        for(int i=0; i<totalLivros;i++){
            printf("-----------------\n");
            printf("Livro %d \n",i+1);
            printf("Nome:%s\n",biblioteca[i].nome);
            printf("Autor:%s\n",biblioteca[i].autor);
            printf("Editora:%s\n",biblioteca[i].editora);
            printf("Edição:%d\n",biblioteca[i].edicao);
        }
        printf("---------------------\n");
      }

      //a pausa é crucial para o usuario veja a lista antes
      //do proximo loop limpa a tela
      printf("\nPressione Enter para continuar...");
      getchar();
      break;

    case 0: //Sair
        printf("\nSaindo do sistema...\n");
        break;

    default://Opcao invalida
       printf("\nOpcao invalida! tente novamente.\n");
       printf("\nPressione Enter para continuar...");
       getchar();
       break;
}


}while (opcao!=0);
return 0;//fim do programa
}
